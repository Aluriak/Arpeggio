<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="Igor DejanoviÄ‡">
        
        <link rel="shortcut icon" href="../img/favicon.ico">

	<title>Troubleshooting - Arpeggio</title>

        <link href="../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="../css/highlight.css">
        <link href="../extra.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->
            <a class="navbar-brand" href="..">Arpeggio</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    <li >
                        <a href="..">Home</a>
                    </li>
                
                
                
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">User Guide <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../getting_started/">Getting started</a>
</li>

                        
                            
<li >
    <a href="../grammars/">Grammars</a>
</li>

                        
                            
<li >
    <a href="../parse_trees/">Parse tree</a>
</li>

                        
                            
<li >
    <a href="../handling_errors/">Handling errors</a>
</li>

                        
                            
<li >
    <a href="../debugging/">Debugging</a>
</li>

                        
                            
<li >
    <a href="../configuration/">Parser configuration</a>
</li>

                        
                            
<li >
    <a href="../semantics/">Semantic analysis</a>
</li>

                        
                            
<li class="active">
    <a href="./">Troubleshooting</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Tutorials <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../tutorials/csv/">CSV</a>
</li>

                        
                            
<li >
    <a href="../tutorials/bibtex/">BibTex</a>
</li>

                        
                            
<li >
    <a href="../tutorials/calc/">Calc</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">About <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../about/discuss/">Discuss</a>
</li>

                        
                            
<li >
    <a href="../about/contributing/">Contributing</a>
</li>

                        
                            
<li >
    <a href="../about/license/">License</a>
</li>

                        
                        </ul>
                    </li>
                
                
                </ul>
            

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                
                    <li >
                        <a rel="next" href="../semantics/">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../tutorials/csv/">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
                
                
                    <li>
                        <a href="https://github.com/igordejanovic/Arpeggio">
                            
                                <i class="fa fa-github"></i>
                            
                            GitHub
                        </a>
                    </li>
                
            </ul>
        </div>
    </div>
</div>

        <div class="container">
            
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#troubleshooting-guide">Troubleshooting Guide</a></li>
        
            <li><a href="#left-recursion-and-recursionerror">Left recursion and RecursionError</a></li>
        
            <li><a href="#unrecognized-grammar-element">Unrecognized grammar element '...'</a></li>
        
            <li><a href="#visitor-method-is-not-called-during-semantic-analysis">Visitor method is not called during semantic analysis</a></li>
        
    
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="troubleshooting-guide">Troubleshooting Guide</h1>
<p>Common problems and mistakes</p>
<hr />
<h2 id="left-recursion-and-recursionerror">Left recursion and RecursionError</h2>
<p>If you get <code>RecursionError: maximum recursion depth exceeded while calling a
Python object</code> it is a good indication that you have a <a href="https://en.wikipedia.org/wiki/Left_recursion">left
recursion</a> in the grammar.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Arpeggio parser will implement a support for detecting and reporting of left
recursions in the grammar. See <a href="https://github.com/igordejanovic/Arpeggio/issues/23">issue
23</a></p>
</div>
<p>A left recursion is found if the parser calls the same rule again while no
characters from the input is consumed from the previous call (e.g. we have the
same state). This will lead to the same sequence of events and we have infinite
loop.</p>
<p>For example, lets suppose that we want to match following string:</p>
<pre><code>b a a a a a a
</code></pre>
<p>We could write a grammar like this:</p>
<pre><code>A = A 'a' / 'b'
</code></pre>
<p>But this grammar is left-recursive and the recursive-descent top-down parser
like Arpeggio will try to loop indefinitely trying to match <code>A</code> over and over
again in the same spot of the input string.</p>
<p>Although, there are techniques to handle left-recursion in top-down parsers
automatically, Arpeggio does not implements them and a classic approach of
<a href="https://en.wikipedia.org/wiki/Left_recursion#Removing_left_recursion">removing left
recursion</a>
must be used.</p>
<p>To remove left recursion from the above grammar we do the following:</p>
<pre><code>A = 'b' 'a'*
</code></pre>
<p>Or, get all non-left recursive choices and put them first (<code>b</code> in this case) and
than add the zero-or-more repetition of the recursive part without the left
recursive non-terminal (<code>a</code> from <code>A 'a'</code> in this case).</p>
<p>Another example:</p>
<pre><code>add = mult / add '+' mult / add '-' mult
</code></pre>
<p>becomes:</p>
<pre><code>add = mult (('+' mult) / ('-' mult))*
</code></pre>
<p>or:</p>
<pre><code>add = mult (('+' / '-') mult)*
</code></pre>
<p>In general:</p>
<pre><code>A = A a1 / A a2 / ... / A an / b1 / b2 / ... / bm
</code></pre>
<p>where uppercase letters represents non-terminals whereas lowercase letters
represent terminals.</p>
<p>Removing left recursion yields:</p>
<pre><code>A = (b1 / b2 / ... / bm) (a1 / a2 / ... / an)*
</code></pre>
<div class="admonition danger">
<p class="admonition-title">Danger</p>
<p>Be aware that the parse tree will not be the same.</p>
</div>
<h2 id="unrecognized-grammar-element">Unrecognized grammar element '...'</h2>
<p>This might happen when non-unicode literals are used. Make sure that you use
unicode literals when defining grammars using Python notation.</p>
<p>You might want to include:</p>
<pre><code class="python">from __future__ import unicode_literals
</code></pre>

<p>This will enable unicode literals in the python &lt; 3.</p>
<h2 id="visitor-method-is-not-called-during-semantic-analysis">Visitor method is not called during semantic analysis</h2>
<p>Semantic analysis operates on a parse tree nodes produced by grammar rules.
If you are using a <code>reduce_tree=True</code> option in the construction of the parser
all non-terminal nodes with only one child will be suppressed in the parse tree.
Thus, visitor methods for those nodes will not be called.</p>
<p>To resolve issue either disable tree reduction during parser construction (i.e.
<code>reduce_tree=False</code>) or do visitor job in some of the calling rules that produce
parse tree node with more than one child.</p>
<p>As a side note, there is implicit reduction of nodes whose grammar rule is a 
sequence with only one child.</p>
<pre><code class="python">def mean():             return number
def number():           return _(r'\d*\.\d*|\d+')
</code></pre>

<p>Here a node <code>number</code> will be suppressed from the parser model and visitor
<code>visit_number</code> will not be called. You have to define <code>visit_mean</code> or a visitor
for some of the rules calling <code>mean</code>.</p>
<p>This implicit reduction can not be disabled at the moment. Please see <a href="https://github.com/igordejanovic/Arpeggio/issues/24">issue
24</a>.</p></div>
            
        </div>

        <footer class="col-md-12">
            <hr>
            
            <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>

        <script src="../js/jquery-1.10.2.min.js"></script>
        <script src="../js/bootstrap-3.0.3.min.js"></script>
        <script src="../js/highlight.pack.js"></script>
        <script>var base_url = '..';</script>
        <script data-main="../mkdocs/js/search.js" src="../mkdocs/js/require.js"></script>
        <script src="../js/base.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                        <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                    </div>
                    <div class="modal-body">
                        <p>
                            From here you can search these documents. Enter
                            your search terms below.
                        </p>
                        <form role="form">
                            <div class="form-group">
                                <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                            </div>
                        </form>
                        <div id="mkdocs-search-results"></div>
                    </div>
                    <div class="modal-footer">
                    </div>
                </div>
            </div>
        </div>

    </body>
</html>
